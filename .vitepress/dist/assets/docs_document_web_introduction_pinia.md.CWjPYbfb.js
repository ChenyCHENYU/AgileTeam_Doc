import{_ as i,c as a,o as n,af as t}from"./chunks/framework.hRqtpD5c.js";const g=JSON.parse('{"title":"å…¨å±€çŠ¶æ€ç®¡ç†","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"docs/document/web/introduction/pinia.md","filePath":"docs/document/web/introduction/pinia.md"}'),e={name:"docs/document/web/introduction/pinia.md"};function h(l,s,p,k,r,d){return n(),a("div",null,s[0]||(s[0]=[t(`<h1 id="å…¨å±€çŠ¶æ€ç®¡ç†" tabindex="-1">å…¨å±€çŠ¶æ€ç®¡ç† <a class="header-anchor" href="#å…¨å±€çŠ¶æ€ç®¡ç†" aria-label="Permalink to â€œå…¨å±€çŠ¶æ€ç®¡ç†â€">â€‹</a></h1><blockquote><p>å®˜æ–¹æ¨å‡ºçš„å…¨å±€çŠ¶æ€ç®¡ç†å·¥å…·ç›®å‰æœ‰ <a href="https://vuex.vuejs.org/zh/" target="_blank" rel="noreferrer">Vuex</a> å’Œ <a href="https://pinia.vuejs.org/" target="_blank" rel="noreferrer">Pinia</a> ï¼Œä¸¤è€…çš„ä½œç”¨å’Œç”¨æ³•éƒ½æ¯”è¾ƒç›¸ä¼¼ï¼Œä½† Pinia çš„è®¾è®¡æ›´è´´è¿‘ Vue 3 ç»„åˆå¼ API çš„ç”¨æ³•ã€‚</p></blockquote><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ä¸‹æ–‡å¤§éƒ¨åˆ†å†…å®¹éƒ½ä¼šå’Œ Vuex ä½œå¯¹æ¯”ï¼Œæ–¹ä¾¿ç›´è§‚äº†è§£ä» Vuex é¡¹ç›®å‘ Pinia çš„è¿ç§»ã€‚</p></div><h2 id="å…³äº-pinia-new" tabindex="-1">å…³äº Pinia ~new <a class="header-anchor" href="#å…³äº-pinia-new" aria-label="Permalink to â€œå…³äº Pinia ~newâ€">â€‹</a></h2><p>ç”±äº Vuex 4.x ç‰ˆæœ¬åªæ˜¯ä¸ªè¿‡æ¸¡ç‰ˆï¼ŒVuex 4 å¯¹ TypeScript å’Œ Composition API éƒ½ä¸æ˜¯å¾ˆå‹å¥½ï¼Œè™½ç„¶å®˜æ–¹å›¢é˜Ÿåœ¨ GitHub å·²æœ‰è®¨è®º <a href="https://github.com/vuejs/rfcs/discussions/270" target="_blank" rel="noreferrer">Vuex 5</a>çš„å¼€å‘ææ¡ˆ(å·²å…³é—­) ï¼Œä½†ä» 2022-02-07 åœ¨ Vue 3 è¢«è®¾ç½®ä¸ºé»˜è®¤ç‰ˆæœ¬å¼€å§‹ï¼Œ Pinia å·²æ­£å¼è¢«å®˜æ–¹æ¨èä½œä¸ºå…¨å±€çŠ¶æ€ç®¡ç†çš„å·¥å…·ã€‚</p><p>Pinia æ”¯æŒ Vue 3 å’Œ Vue 2 ï¼Œå¯¹ TypeScript ä¹Ÿæœ‰å¾ˆå®Œå¥½çš„æ”¯æŒã€‚</p><p>ç‚¹å‡»è®¿é—®ï¼š<a href="https://pinia.vuejs.org/" target="_blank" rel="noreferrer">Pinia å®˜ç½‘</a></p><h2 id="å®‰è£…å’Œå¯ç”¨-new" tabindex="-1">å®‰è£…å’Œå¯ç”¨ ~new <a class="header-anchor" href="#å®‰è£…å’Œå¯ç”¨-new" aria-label="Permalink to â€œå®‰è£…å’Œå¯ç”¨ ~newâ€">â€‹</a></h2><p>Pinia ç›®å‰è¿˜æ²¡æœ‰è¢«å¹¿æ³›çš„é»˜è®¤é›†æˆåœ¨å„ç§è„šæ‰‹æ¶é‡Œï¼Œæ‰€ä»¥å¦‚æœåŸæ¥åˆ›å»ºçš„é¡¹ç›®æ²¡æœ‰ Pinia ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨å®‰è£…å®ƒã€‚</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># éœ€è¦ cd åˆ°çš„é¡¹ç›®ç›®å½•ä¸‹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pinia</span></span></code></pre></div><p>æŸ¥çœ‹çš„ package.json ï¼Œçœ‹çœ‹é‡Œé¢çš„ <code>dependencies</code> æ˜¯å¦æˆåŠŸåŠ å…¥äº† Pinia å’Œå®ƒçš„ç‰ˆæœ¬å·ï¼ˆä¸‹æ–¹æ˜¯ç¤ºä¾‹ä»£ç ï¼Œä»¥å®é™…å®‰è£…çš„æœ€æ–°ç‰ˆæœ¬å·ä¸ºå‡†ï¼‰ï¼š</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;dependencies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;pinia&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;^2.0.11&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç„¶åæ‰“å¼€ <code>src/main.ts</code> æ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢é‚£ä¸¤è¡Œæœ‰æ³¨é‡Šçš„æ–°ä»£ç ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createApp } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createPinia } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // å¯¼å…¥ Pinia</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> App </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/App.vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(App)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createPinia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¯ç”¨ Pinia</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#app&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>åˆ°è¿™é‡Œï¼Œ Pinia å°±é›†æˆåˆ°çš„é¡¹ç›®é‡Œäº†ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ä¹Ÿå¯ä»¥é€šè¿‡ <a href="./upgrade.html#create-preset">Create Preset</a> åˆ›å»ºæ–°é¡¹ç›®ï¼ˆé€‰æ‹© <code>vue</code> æŠ€æœ¯æ ˆè¿›å…¥ï¼Œé€‰æ‹© <a href="https://github.com/awesome-starter/vue3-ts-vite-starter" target="_blank" rel="noreferrer">vue3-ts-vite</a> æ¨¡æ¿ï¼‰ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªé›†æˆå¸¸ç”¨é…ç½®çš„é¡¹ç›®å¯åŠ¨æ¨¡æ¿ï¼Œè¯¥æ¨¡æ¿ç°åœ¨ä½¿ç”¨ Pinia ä½œä¸ºå…¨å±€çŠ¶æ€ç®¡ç†å·¥å…·ã€‚</p></div><h2 id="çŠ¶æ€æ ‘çš„ç»“æ„-new" tabindex="-1">çŠ¶æ€æ ‘çš„ç»“æ„ ~new <a class="header-anchor" href="#çŠ¶æ€æ ‘çš„ç»“æ„-new" aria-label="Permalink to â€œçŠ¶æ€æ ‘çš„ç»“æ„ ~newâ€">â€‹</a></h2><p>åœ¨å¼€å§‹å†™ä»£ç ä¹‹å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸ªå¯¹æ¯”ï¼Œç›´è§‚çš„äº†è§£ Pinia çš„çŠ¶æ€æ ‘æ„æˆï¼Œæ‰èƒ½åœ¨åé¢çš„ç¯èŠ‚æ›´å¥½çš„ç†è§£æ¯ä¸ªåŠŸèƒ½çš„ç”¨é€”ã€‚</p><p>é‰´äºå¯èƒ½æœ‰éƒ¨åˆ†å¼€å‘è€…ä¹‹å‰æœªç”¨è¿‡ Vuex ï¼Œæ‰€ä»¥åŠ å…¥ Vue ç»„ä»¶ä¸€èµ·å¯¹æ¯”ï¼ˆ Options API å†™æ³•ï¼‰ã€‚</p><table tabindex="0"><thead><tr><th style="text-align:center;">ä½œç”¨</th><th style="text-align:center;">Vue Component</th><th style="text-align:center;">Vuex</th><th style="text-align:center;">Pinia</th></tr></thead><tbody><tr><td style="text-align:center;">æ•°æ®ç®¡ç†</td><td style="text-align:center;">data</td><td style="text-align:center;">state</td><td style="text-align:center;">state</td></tr><tr><td style="text-align:center;">æ•°æ®è®¡ç®—</td><td style="text-align:center;">computed</td><td style="text-align:center;">getters</td><td style="text-align:center;">getters</td></tr><tr><td style="text-align:center;">è¡Œä¸ºæ–¹æ³•</td><td style="text-align:center;">methods</td><td style="text-align:center;">mutations / actions</td><td style="text-align:center;">actions</td></tr></tbody></table><p>å¯ä»¥çœ‹åˆ° Pinia çš„ç»“æ„å’Œç”¨é€”éƒ½å’Œ Vuex ä¸ Component éå¸¸ç›¸ä¼¼ï¼Œå¹¶ä¸” Pinia ç›¸å¯¹äº Vuex ï¼Œåœ¨è¡Œä¸ºæ–¹æ³•éƒ¨åˆ†å»æ‰äº† mutations ï¼ˆåŒæ­¥æ“ä½œï¼‰å’Œ actions ï¼ˆå¼‚æ­¥æ“ä½œï¼‰çš„åŒºåˆ†ï¼Œæ›´æ¥è¿‘ç»„ä»¶çš„ç»“æ„ï¼Œä¸Šæ‰‹æˆæœ¬ä¼šæ›´ä½ä¸€äº›ã€‚</p><p>ä¸‹é¢æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„ Store ï¼Œå¼€å§‹ç”¨ Pinia æ¥è¿›è¡ŒçŠ¶æ€ç®¡ç†ã€‚</p><h2 id="åˆ›å»º-store-new" tabindex="-1">åˆ›å»º Store ~new <a class="header-anchor" href="#åˆ›å»º-store-new" aria-label="Permalink to â€œåˆ›å»º Store ~newâ€">â€‹</a></h2><blockquote><p>å’Œ Vuex ä¸€æ ·ï¼Œ Pinia çš„æ ¸å¿ƒä¹Ÿæ˜¯ç§°ä¹‹ä¸º Store ã€‚</p></blockquote><p>å‚ç…§ Pinia å®˜ç½‘æ¨èçš„é¡¹ç›®ç®¡ç†æ–¹æ¡ˆï¼Œä¹Ÿæ˜¯å…ˆåœ¨ <code>src</code> æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª <code>stores</code> æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨é‡Œé¢æ·»åŠ ä¸€ä¸ª <code>index.ts</code> æ–‡ä»¶ï¼Œç„¶åå°±å¯ä»¥æ¥æ·»åŠ ä¸€ä¸ªæœ€åŸºç¡€çš„ Store ã€‚</p><p>Store æ˜¯é€šè¿‡ <code>defineStore</code> æ–¹æ³•æ¥åˆ›å»ºçš„ï¼Œå®ƒæœ‰ä¸¤ç§å…¥å‚å½¢å¼ï¼š</p><h3 id="å½¢å¼-1-æ¥æ”¶ä¸¤ä¸ªå‚æ•°" tabindex="-1">å½¢å¼ 1 ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•° <a class="header-anchor" href="#å½¢å¼-1-æ¥æ”¶ä¸¤ä¸ªå‚æ•°" aria-label="Permalink to â€œå½¢å¼ 1 ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°â€">â€‹</a></h3><p>æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ Store çš„å”¯ä¸€ ID ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ Store çš„é€‰é¡¹ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Store é€‰é¡¹...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="å½¢å¼-2-æ¥æ”¶ä¸€ä¸ªå‚æ•°" tabindex="-1">å½¢å¼ 2 ï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•° <a class="header-anchor" href="#å½¢å¼-2-æ¥æ”¶ä¸€ä¸ªå‚æ•°" aria-label="Permalink to â€œå½¢å¼ 2 ï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°â€">â€‹</a></h3><p>æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œç›´æ¥ä¼ å…¥ Store çš„é€‰é¡¹ï¼Œä½†æ˜¯éœ€è¦æŠŠå”¯ä¸€ ID ä½œä¸ºé€‰é¡¹çš„ä¸€éƒ¨åˆ†ä¸€èµ·ä¼ å…¥ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Store é€‰é¡¹...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ä¸è®ºæ˜¯å“ªç§åˆ›å»ºå½¢å¼ï¼Œéƒ½å¿…é¡»ä¸º Store æŒ‡å®šä¸€ä¸ªå”¯ä¸€ IDï¼Œæ¯”è¾ƒæ¨èç¬¬ä¸€ç§æ–¹å¼ ã€‚</p></div><p>å¦å¤–å¯ä»¥çœ‹åˆ°è¿™é‡ŒæŠŠå¯¼å‡ºçš„å‡½æ•°åå‘½åä¸º <code>useStore</code> ï¼Œä»¥ <code>use</code> å¼€å¤´æ˜¯ Vue 3 å¯¹å¯ç»„åˆå‡½æ•°çš„ä¸€ä¸ªå‘½åçº¦å®šã€‚</p><p>å¹¶ä¸”ä½¿ç”¨çš„æ˜¯ <code>export const</code> è€Œä¸æ˜¯ <code>export default</code> ï¼ˆè¯¦è§ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/export" target="_blank" rel="noreferrer">å‘½åå¯¼å‡ºå’Œé»˜è®¤å¯¼å‡º</a>ï¼‰ï¼Œè¿™æ ·åœ¨ä½¿ç”¨çš„æ—¶å€™å¯ä»¥å’Œå…¶ä»–çš„ Vue ç»„åˆå‡½æ•°ä¿æŒä¸€è‡´ï¼Œéƒ½æ˜¯é€šè¿‡ <code>import { xxx } from &#39;xxx&#39;</code> æ¥å¯¼å…¥ã€‚</p><p>å¦‚æœæœ‰å¤šä¸ª Store ï¼Œå¯ä»¥åˆ†æ¨¡å—ç®¡ç†ï¼Œå¹¶æ ¹æ®å®é™…çš„åŠŸèƒ½ç”¨é€”è¿›è¡Œå‘½åï¼ˆ e.g. <code>useMessageStore</code> ã€ <code>useUserStore</code> ã€ <code>useGameStore</code> â€¦ ï¼‰ã€‚</p><h2 id="ç®¡ç†-state-new" tabindex="-1">ç®¡ç† state ~new <a class="header-anchor" href="#ç®¡ç†-state-new" aria-label="Permalink to â€œç®¡ç† state ~newâ€">â€‹</a></h2><blockquote><p>Pinia ä¹Ÿæ˜¯åœ¨ <code>state</code> é‡Œé¢å®šä¹‰çŠ¶æ€æ•°æ®ã€‚</p></blockquote><h3 id="ç»™-store-æ·»åŠ -state" tabindex="-1">ç»™ Store æ·»åŠ  state <a class="header-anchor" href="#ç»™-store-æ·»åŠ -state" aria-label="Permalink to â€œç»™ Store æ·»åŠ  stateâ€">â€‹</a></h3><p>å®ƒæ˜¯é€šè¿‡ä¸€ä¸ªç®­å¤´å‡½æ•°çš„å½¢å¼æ¥è¿”å›æ•°æ®ï¼Œå¹¶ä¸”èƒ½å¤Ÿæ­£ç¡®çš„å¸®æ¨å¯¼ TypeScript ç±»å‹ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å…ˆå®šä¹‰ä¸€ä¸ªæœ€åŸºæœ¬çš„ message æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>ğŸ”” éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œå¦‚æœä¸æ˜¾å¼ return ï¼Œç®­å¤´å‡½æ•°çš„è¿”å›å€¼éœ€è¦ç”¨åœ†æ‹¬å· <code>()</code> å¥—èµ·æ¥ï¼Œè¿™ä¸ªæ˜¯ç®­å¤´å‡½æ•°çš„è¦æ±‚ï¼ˆè¯¦è§ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions#%E8%BF%94%E5%9B%9E%E5%AF%B9%E8%B1%A1%E5%AD%97%E9%9D%A2%E9%87%8F" target="_blank" rel="noreferrer">è¿”å›å¯¹è±¡å­—é¢é‡</a>ï¼‰ã€‚</p><p>æ‰€ä»¥ç›¸å½“äºè¿™æ ·å†™ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>è¿˜æ˜¯æ›´æ¨èåŠ åœ†æ‹¬å·çš„ç®€å†™æ–¹å¼ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>å¯èƒ½æœ‰å¼€å‘è€…ä¼šé—®ï¼š Vuex å¯ä»¥ç”¨ä¸€ä¸ªå¯¹è±¡æ¥å®šä¹‰ state çš„æ•°æ®ï¼Œ Pinia å¯ä»¥å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯ï¼šä¸å¯ä»¥ï¼ state çš„ç±»å‹å¿…é¡»æ˜¯ <code>state?: (() =&gt; {}) | undefined</code> ï¼Œè¦ä¹ˆä¸é…ç½®ï¼ˆå°±æ˜¯ undefined ï¼‰ï¼Œè¦ä¹ˆåªèƒ½æ˜¯ä¸ªç®­å¤´å‡½æ•°ã€‚</p></div><h3 id="æ‰‹åŠ¨æŒ‡å®šæ•°æ®ç±»å‹" tabindex="-1">æ‰‹åŠ¨æŒ‡å®šæ•°æ®ç±»å‹ <a class="header-anchor" href="#æ‰‹åŠ¨æŒ‡å®šæ•°æ®ç±»å‹" aria-label="Permalink to â€œæ‰‹åŠ¨æŒ‡å®šæ•°æ®ç±»å‹â€">â€‹</a></h3><p>è™½ç„¶ Pinia ä¼šå¸®åŠ©è‡ªåŠ¨æ¨å¯¼ TypeScript çš„æ•°æ®ç±»å‹ï¼Œä½†æœ‰æ—¶å€™å¯èƒ½ä¸å¤ªå¤Ÿç”¨ï¼Œæ¯”å¦‚ä¸‹é¢è¿™æ®µä»£ç ï¼Œè¯·ç•™æ„ä»£ç æ³¨é‡Šçš„è¯´æ˜ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // æ·»åŠ äº†ä¸€ä¸ªéšæœºæ¶ˆæ¯æ•°ç»„</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      randomMessages: [],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>é¢„æœŸåº”è¯¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ <code>string[]</code> ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™ Pinia ä¼šå¸®æ¨å¯¼æˆ <code>never[]</code> ï¼Œé‚£ä¹ˆç±»å‹å°±å¯¹ä¸ä¸Šäº†ã€‚</p><p>è¿™ç§æƒ…å†µä¸‹å°±éœ€è¦æ‰‹åŠ¨æŒ‡å®š randomMessages çš„ç±»å‹ï¼Œå¯ä»¥é€šè¿‡ <code>as</code> æ¥æŒ‡å®šï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // é€šè¿‡ as å…³é”®å­—æŒ‡å®š TS ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      randomMessages: [] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>æˆ–è€…ä½¿ç”¨å°–æ‹¬å· <code>&lt;&gt;</code> æ¥æŒ‡å®šï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // é€šè¿‡å°–æ‹¬å·æŒ‡å®š TS ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      randomMessages: &lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]&gt;[],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>è¿™ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ã€‚</p><h3 id="è·å–å’Œæ›´æ–°-state" tabindex="-1">è·å–å’Œæ›´æ–° state <a class="header-anchor" href="#è·å–å’Œæ›´æ–°-state" aria-label="Permalink to â€œè·å–å’Œæ›´æ–° stateâ€">â€‹</a></h3><p>è·å– state æœ‰å¤šç§æ–¹æ³•ï¼Œç•¥å¾®æœ‰åŒºåˆ«ï¼ˆè¯¦è§ä¸‹æ–¹å„è‡ªçš„è¯´æ˜ï¼‰ï¼Œä½†ç›¸åŒçš„æ˜¯ï¼Œä»–ä»¬éƒ½æ˜¯å“åº”æ€§çš„ã€‚</p><div class="warning custom-block"><p class="custom-block-title custom-block-title-default">WARNING</p><p>ä¸èƒ½ç›´æ¥é€šè¿‡ ES6 è§£æ„çš„æ–¹å¼ï¼ˆ e.g. <code>const { message } = store</code> ï¼‰ï¼Œé‚£æ ·ä¼šç ´åæ•°æ®çš„å“åº”æ€§ã€‚</p></div><h4 id="ä½¿ç”¨-store-å®ä¾‹" tabindex="-1">ä½¿ç”¨ store å®ä¾‹ <a class="header-anchor" href="#ä½¿ç”¨-store-å®ä¾‹" aria-label="Permalink to â€œä½¿ç”¨ store å®ä¾‹â€">â€‹</a></h4><p>ç”¨æ³•å’Œ Vuex ç›¸ä¼¼ï¼Œæœ‰ä¸€ç‚¹åŒºåˆ«æ˜¯ï¼Œæ•°æ®ç›´æ¥æ˜¯æŒ‚åœ¨ <code>store</code> ä¸Šçš„ï¼Œè€Œä¸æ˜¯ <code>store.state</code> ä¸Šé¢ï¼</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>e.g. Vuex æ˜¯ <code>store.state.message</code> ï¼Œ Pinia æ˜¯ <code>store.message</code> ã€‚</p></div><p>æ‰€ä»¥ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ <code>store.message</code> ç›´æ¥è°ƒç”¨ state é‡Œçš„æ•°æ®ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineComponent } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // åƒ useRouter é‚£æ ·å®šä¹‰ä¸€ä¸ªå˜é‡æ‹¿åˆ°å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ç›´æ¥é€šè¿‡å®ä¾‹æ¥è·å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.message)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è¿™ç§æ–¹å¼éœ€è¦æŠŠæ•´ä¸ª store ç»™åˆ° template å»æ¸²æŸ“æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      store,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>ä½†ä¸€äº›æ¯”è¾ƒå¤æ‚çš„æ•°æ®è¿™æ ·å†™ä¼šå¾ˆé•¿ï¼Œæ‰€ä»¥æœ‰æ—¶å€™æ›´æ¨èç”¨ä¸‹é¢ä»‹ç»çš„ <a href="#ä½¿ç”¨-computed-api">computed API</a> å’Œ <a href="#ä½¿ç”¨-storetorefs-api">storeToRefs API</a> ç­‰æ–¹å¼æ¥è·å–ã€‚</p><p>åœ¨æ•°æ®æ›´æ–°æ–¹é¢ï¼Œåœ¨ Pinia å¯ä»¥ç›´æ¥é€šè¿‡ Store å®ä¾‹æ›´æ–° state ï¼ˆè¿™ä¸€ç‚¹ä¸ Vuex æœ‰æ˜æ˜¾çš„ä¸åŒï¼Œ<a href="https://vuex.vuejs.org/zh/guide/mutations.html" target="_blank" rel="noreferrer">æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutation</a>ï¼‰ï¼ŒPinia å¦‚æœè¦æ›´æ–° <code>message</code> ï¼Œåªéœ€è¦åƒä¸‹é¢è¿™æ ·ï¼Œå°±å¯ä»¥æ›´æ–° <code>message</code> çš„å€¼äº†ï¼</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;New Message.&#39;</span></span></code></pre></div><h4 id="ä½¿ç”¨-computed-api" tabindex="-1">ä½¿ç”¨ computed API <a class="header-anchor" href="#ä½¿ç”¨-computed-api" aria-label="Permalink to â€œä½¿ç”¨ computed APIâ€">â€‹</a></h4><p>ç°åœ¨ state é‡Œå·²ç»æœ‰å®šä¹‰å¥½çš„æ•°æ®äº†ï¼Œä¸‹é¢è¿™æ®µä»£ç æ˜¯åœ¨ Vue ç»„ä»¶é‡Œå¯¼å…¥çš„ Store ï¼Œå¹¶é€šè¿‡è®¡ç®—æ•°æ® <code>computed</code> æ‹¿åˆ°é‡Œé¢çš„ <code>message</code> æ•°æ®ä¼ ç»™ template ä½¿ç”¨ã€‚</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> lang</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { computed, defineComponent } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // åƒ useRouter é‚£æ ·å®šä¹‰ä¸€ä¸ªå˜é‡æ‹¿åˆ°å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // é€šè¿‡è®¡ç®—æ‹¿åˆ°é‡Œé¢çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.message)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message.value)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ä¼ ç»™ template ä½¿ç”¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">script</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>å’Œ <a href="#ä½¿ç”¨-store-å®ä¾‹">ä½¿ç”¨ store å®ä¾‹</a> åŠ <a href="#ä½¿ç”¨-storetorefs-api">ä½¿ç”¨ storeToRefs API</a> ä¸åŒï¼Œæ­¤æ–¹å¼é»˜è®¤æƒ…å†µä¸‹æ— æ³•ç›´æ¥æ›´æ–° state çš„å€¼ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>åœ¨è¿™é‡Œä½¿ç”¨ <code>computed</code> çš„å®šä¹‰çš„ <code>message</code> å˜é‡æ˜¯ä¸€ä¸ªåªæœ‰ getter ï¼Œæ²¡æœ‰ setter çš„ <a href="./../introduction/component.html#ç±»å‹å®šä¹‰">ComputedRef</a> æ•°æ®ï¼Œæ‰€ä»¥å®ƒæ˜¯åªè¯»çš„ã€‚</p></div><p>å¦‚æœè¦æ›´æ–°æ•°æ®æ€ä¹ˆåŠï¼Ÿ</p><ol><li>åœ¨å®šä¹‰ computed å˜é‡çš„æ—¶å€™ï¼Œé…ç½®å¥½ <a href="./../introduction/component.html#setter-çš„ä½¿ç”¨">setter</a> çš„è¡Œä¸ºï¼š</li><li>å¯ä»¥é€šè¿‡æå‰å®šä¹‰å¥½çš„ Store Actions æ–¹æ³•è¿›è¡Œæ›´æ–°ã€‚</li></ol><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…¶ä»–ä»£ç å’Œä¸Šä¸€ä¸ªä¾‹å­ä¸€æ ·ï¼Œè¿™é‡Œçœç•¥...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¿®æ”¹ï¼šå®šä¹‰ computed å˜é‡çš„æ—¶å€™é…ç½® getter å’Œ setter</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // getter è¿˜æ˜¯è¿”å›æ•°æ®çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.message,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // é…ç½® setter æ¥å®šä¹‰èµ‹å€¼åçš„è¡Œä¸º</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newVal</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newVal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ­¤æ—¶ä¸å†æŠ›å‡º Write operation failed: computed value is readonly çš„è­¦å‘Š</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">message.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;New Message.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// store ä¸Šçš„æ•°æ®å·²æˆåŠŸå˜æˆäº† New Message.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.message)</span></span></code></pre></div><h4 id="ä½¿ç”¨-storetorefs-api" tabindex="-1">ä½¿ç”¨ storeToRefs API <a class="header-anchor" href="#ä½¿ç”¨-storetorefs-api" aria-label="Permalink to â€œä½¿ç”¨ storeToRefs APIâ€">â€‹</a></h4><p>Pinia è¿˜æä¾›äº†ä¸€ä¸ª <code>storeToRefs</code> API ç”¨äºæŠŠ state çš„æ•°æ®è½¬æ¢ä¸º <code>ref</code> å˜é‡ã€‚</p><p>è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ä¸º Pinia Stores è®¾è®¡çš„ API ï¼Œç±»ä¼¼äº <a href="./../introduction/component.html#å“åº”å¼-api-ä¹‹-toref-ä¸-torefs-new">toRefs</a> ï¼ŒåŒºåˆ«åœ¨äºï¼Œå®ƒä¼šå¿½ç•¥æ‰ Store ä¸Šé¢çš„æ–¹æ³•å’Œéå“åº”æ€§çš„æ•°æ®ï¼Œåªè¿”å› state ä¸Šçš„å“åº”æ€§æ•°æ®ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineComponent } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è®°å¾—å¯¼å…¥è¿™ä¸ª API</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { storeToRefs } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // é€šè¿‡ storeToRefs æ¥æ‹¿åˆ°å“åº”æ€§çš„ message</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> storeToRefs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message.value)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>é€šè¿‡è¿™ä¸ªæ–¹å¼æ‹¿åˆ°çš„ <code>message</code> å˜é‡æ˜¯ä¸€ä¸ª <a href="./../introduction/component.html#å“åº”å¼-api-ä¹‹-ref-new">Ref</a> ç±»å‹çš„æ•°æ®ï¼Œæ‰€ä»¥å¯ä»¥åƒæ™®é€šçš„ ref å˜é‡ä¸€æ ·è¿›è¡Œè¯»å–å’Œèµ‹å€¼ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç›´æ¥èµ‹å€¼å³å¯</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">message.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;New Message.&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// store ä¸Šçš„æ•°æ®å·²æˆåŠŸå˜æˆäº† New Message.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.message)</span></span></code></pre></div><h4 id="ä½¿ç”¨-torefs-api" tabindex="-1">ä½¿ç”¨ toRefs API <a class="header-anchor" href="#ä½¿ç”¨-torefs-api" aria-label="Permalink to â€œä½¿ç”¨ toRefs APIâ€">â€‹</a></h4><p>å¦‚ <a href="#ä½¿ç”¨-storetorefs-api">ä½¿ç”¨ storeToRefs API</a> éƒ¨åˆ†æ‰€è¯´ï¼Œè¯¥ API æœ¬èº«çš„è®¾è®¡å°±æ˜¯ç±»ä¼¼äº <a href="./../introduction/component.html#å“åº”å¼-api-ä¹‹-toref-ä¸-torefs-new">toRefs</a> ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ toRefs æŠŠ state ä¸Šçš„æ•°æ®è½¬æˆ ref å˜é‡ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ³¨æ„ toRefs æ˜¯ vue çš„ API ï¼Œä¸æ˜¯ Pinia</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineComponent, toRefs } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è·Ÿ storeToRefs æ“ä½œéƒ½ä¸€æ ·ï¼Œåªä¸è¿‡ç”¨ Vue çš„è¿™ä¸ª API æ¥å¤„ç†</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toRefs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message.value)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å¦å¤–ï¼Œåƒä¸Šé¢è¿™æ ·ï¼Œå¯¹ store æ‰§è¡Œ toRefs ä¼šæŠŠ store ä¸Šé¢çš„ getters ã€ actions ä¹Ÿä¸€èµ·æå–ï¼Œå¦‚æœåªéœ€è¦æå– state ä¸Šçš„æ•°æ®ï¼Œå¯ä»¥è¿™æ ·åšï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åªä¼ å…¥ store.$state</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toRefs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.$state)</span></span></code></pre></div><h4 id="ä½¿ç”¨-toref-api" tabindex="-1">ä½¿ç”¨ toRef API <a class="header-anchor" href="#ä½¿ç”¨-toref-api" aria-label="Permalink to â€œä½¿ç”¨ toRef APIâ€">â€‹</a></h4><p>toRef æ˜¯ toRefs çš„å…„å¼Ÿ API ï¼Œä¸€ä¸ªæ˜¯åªè½¬æ¢ä¸€ä¸ªå­—æ®µï¼Œä¸€ä¸ªæ˜¯è½¬æ¢æ‰€æœ‰å­—æ®µï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥ç”¨æ¥è½¬æ¢ state æ•°æ®å˜æˆ ref å˜é‡ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ³¨æ„ toRef æ˜¯ vue çš„ API ï¼Œä¸æ˜¯ Pinia</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineComponent, toRef } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // éµå¾ª toRef çš„ç”¨æ³•å³å¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> message</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> toRef</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, message.value)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h4 id="ä½¿ç”¨-actions-æ–¹æ³•" tabindex="-1">ä½¿ç”¨ actions æ–¹æ³• <a class="header-anchor" href="#ä½¿ç”¨-actions-æ–¹æ³•" aria-label="Permalink to â€œä½¿ç”¨ actions æ–¹æ³•â€">â€‹</a></h4><p>åœ¨ Vuex ï¼Œå¦‚æœæƒ³é€šè¿‡æ–¹æ³•æ¥æ“ä½œ state çš„æ›´æ–°ï¼Œå¿…é¡»é€šè¿‡ mutation æ¥æäº¤ï¼›è€Œå¼‚æ­¥æ“ä½œéœ€è¦æ›´å¤šä¸€ä¸ªæ­¥éª¤ï¼Œå¿…é¡»å…ˆé€šè¿‡ action æ¥è§¦å‘ mutation ï¼Œéå¸¸ç¹çï¼</p><p>Pinia æ‰€æœ‰æ“ä½œéƒ½é›†åˆä¸º action ï¼Œæ— éœ€åŒºåˆ†åŒæ­¥å’Œå¼‚æ­¥ï¼ŒæŒ‰ç…§å¹³æ—¶çš„å‡½æ•°å®šä¹‰å³å¯æ›´æ–° state ï¼Œå…·ä½“æ“ä½œè¯¦è§ <a href="#ç®¡ç†-actions-new">ç®¡ç† actions</a>ã€‚</p><h3 id="æ‰¹é‡æ›´æ–°-state" tabindex="-1">æ‰¹é‡æ›´æ–° state <a class="header-anchor" href="#æ‰¹é‡æ›´æ–°-state" aria-label="Permalink to â€œæ‰¹é‡æ›´æ–° stateâ€">â€‹</a></h3><p>åœ¨ <a href="#è·å–å’Œæ›´æ–°-state">è·å–å’Œæ›´æ–° state</a> éƒ¨åˆ†è¯´çš„éƒ½æ˜¯å¦‚ä½•ä¿®æ”¹å•ä¸ª state æ•°æ®ï¼Œé‚£ä¹ˆæœ‰æ—¶å€™è¦åŒæ—¶ä¿®æ”¹å¾ˆå¤šä¸ªï¼Œä¼šæ˜¾å¾—æ¯”è¾ƒç¹çã€‚</p><p>å¦‚æœå†™è¿‡ React æˆ–è€…å¾®ä¿¡å°ç¨‹åºï¼Œåº”è¯¥éå¸¸ç†Ÿæ‚‰è¿™äº›ç”¨æ³•ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸‹é¢ä¸æ˜¯ Vue çš„ä»£ç ï¼Œä¸è¦åœ¨çš„é¡¹ç›®é‡Œä½¿ç”¨</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// React</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setState</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  foo: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New Foo Value&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  bar: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New bar Value&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¾®ä¿¡å°ç¨‹åº</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setData</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  foo: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New Foo Value&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  bar: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New bar Value&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>Pinia ä¹Ÿæä¾›äº†ä¸€ä¸ª <code>$patch</code> API ç”¨äºåŒæ—¶ä¿®æ”¹å¤šä¸ªæ•°æ®ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼š</p><table tabindex="0"><thead><tr><th style="text-align:center;">å‚æ•°</th><th style="text-align:center;">ç±»å‹</th><th style="text-align:center;">è¯­æ³•</th></tr></thead><tbody><tr><td style="text-align:center;">partialState</td><td style="text-align:center;">å¯¹è±¡ / å‡½æ•°</td><td style="text-align:center;">store.$patch(partialState)</td></tr></tbody></table><h4 id="ä¼ å…¥ä¸€ä¸ªå¯¹è±¡" tabindex="-1">ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ <a class="header-anchor" href="#ä¼ å…¥ä¸€ä¸ªå¯¹è±¡" aria-label="Permalink to â€œä¼ å…¥ä¸€ä¸ªå¯¹è±¡â€">â€‹</a></h4><p>å½“å‚æ•°ç±»å‹ä¸ºå¯¹è±¡æ—¶ï¼Œ<code>key</code> æ˜¯è¦ä¿®æ”¹çš„ state æ•°æ®åç§°ï¼Œ <code>value</code> æ˜¯æ–°çš„å€¼ï¼ˆæ”¯æŒåµŒå¥—ä¼ å€¼ï¼‰ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç»§ç»­ç”¨å‰é¢çš„æ•°æ®ï¼Œè¿™é‡Œä¼šæ‰“å°å‡ºä¿®æ”¹å‰çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.$state))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¾“å‡º {&quot;message&quot;:&quot;Hello World&quot;,&quot;randomMessages&quot;:[]}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * æ³¨æ„è¿™é‡Œï¼Œä¼ å…¥äº†ä¸€ä¸ªå¯¹è±¡</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New Message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  randomMessages: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;msg1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;msg2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;msg3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™é‡Œä¼šæ‰“å°å‡ºä¿®æ”¹åçš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.$state))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¾“å‡º {&quot;message&quot;:&quot;New Message&quot;,&quot;randomMessages&quot;:[&quot;msg1&quot;,&quot;msg2&quot;,&quot;msg3&quot;]}</span></span></code></pre></div><p>å¯¹äºç®€å•çš„æ•°æ®ï¼Œç›´æ¥ä¿®æ”¹æˆæ–°å€¼æ˜¯éå¸¸å¥½ç”¨çš„ã€‚</p><p>ä½†æœ‰æ—¶å€™å¹¶ä¸å•å•åªæ˜¯ä¿®æ”¹ï¼Œè€Œæ˜¯è¦å¯¹æ•°æ®è¿›è¡Œæ‹¼æ¥ã€è¡¥å……ã€åˆå¹¶ç­‰æ“ä½œï¼Œç›¸å¯¹è€Œè¨€å¼€é”€å°±ä¼šå¾ˆå¤§ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œæ›´é€‚åˆ <a href="#ä¼ å…¥ä¸€ä¸ªå‡½æ•°">ä¼ å…¥ä¸€ä¸ªå‡½æ•°</a> æ¥å¤„ç†ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ä½¿ç”¨è¿™ä¸ªæ–¹å¼æ—¶ï¼Œ <code>key</code> åªå…è®¸æ˜¯å®ä¾‹ä¸Šå·²æœ‰çš„æ•°æ®ï¼Œä¸å¯ä»¥æäº¤æœªå®šä¹‰çš„æ•°æ®è¿›å»ã€‚</p><p>å¼ºåˆ¶æäº¤çš„è¯ï¼Œåœ¨ TypeScript ä¼šæŠ›å‡ºé”™è¯¯ï¼Œ JavaScript è™½ç„¶ä¸ä¼šæŠ¥é”™ï¼Œä½†å®é™…ä¸Šï¼Œ Store å®ä¾‹ä¸Šé¢ä¾ç„¶ä¸ä¼šæœ‰è¿™ä¸ªæ–°å¢çš„éæ³•æ•°æ®ã€‚</p></div><h4 id="ä¼ å…¥ä¸€ä¸ªå‡½æ•°" tabindex="-1">ä¼ å…¥ä¸€ä¸ªå‡½æ•° <a class="header-anchor" href="#ä¼ å…¥ä¸€ä¸ªå‡½æ•°" aria-label="Permalink to â€œä¼ å…¥ä¸€ä¸ªå‡½æ•°â€">â€‹</a></h4><p>å½“å‚æ•°ç±»å‹ä¸ºå‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°ä¼šæœ‰ä¸€ä¸ªå…¥å‚ <code>state</code> ï¼Œæ˜¯å½“å‰å®ä¾‹çš„ state ï¼Œç­‰ä»·äº store.$state ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™é‡Œä¼šæ‰“å°å‡ºä¿®æ”¹å‰çš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.$state))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¾“å‡º {&quot;message&quot;:&quot;Hello World&quot;,&quot;randomMessages&quot;:[]}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * æ³¨æ„è¿™é‡Œï¼Œè¿™æ¬¡æ˜¯ä¼ å…¥äº†ä¸€ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  state.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;New Message&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // æ•°ç»„æ”¹æˆç”¨è¿½åŠ çš„æ–¹å¼ï¼Œè€Œä¸æ˜¯é‡æ–°èµ‹å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">let</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    state.randomMessages.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`msg\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™é‡Œä¼šæ‰“å°å‡ºä¿®æ”¹åçš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.$state))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¾“å‡º {&quot;message&quot;:&quot;New Message&quot;,&quot;randomMessages&quot;:[&quot;msg1&quot;,&quot;msg2&quot;,&quot;msg3&quot;]}</span></span></code></pre></div><p>å’Œ <a href="#ä¼ å…¥ä¸€ä¸ªå¯¹è±¡">ä¼ å…¥ä¸€ä¸ªå¯¹è±¡</a> æ¯”ï¼Œä¸ä¸€å®šè¯´å°±æ˜¯å“ªç§æ–¹å¼æ›´å¥½ï¼Œé€šå¸¸è¦ç»“åˆä¸šåŠ¡åœºæ™¯åˆç†ä½¿ç”¨ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>ä½¿ç”¨è¿™ä¸ªæ–¹å¼æ—¶ï¼Œå’Œ <a href="#ä¼ å…¥ä¸€ä¸ªå¯¹è±¡">ä¼ å…¥ä¸€ä¸ªå¯¹è±¡</a> ä¸€æ ·åªèƒ½ä¿®æ”¹å·²å®šä¹‰çš„æ•°æ®ï¼Œå¹¶ä¸”å¦å¤–éœ€è¦æ³¨æ„ï¼Œä¼ è¿›å»çš„å‡½æ•°åªèƒ½æ˜¯åŒæ­¥å‡½æ•°ï¼Œä¸å¯ä»¥æ˜¯å¼‚æ­¥å‡½æ•°ï¼</p><p>å¦‚æœè¿˜ä¸æ¸…æ¥šä»€ä¹ˆæ˜¯åŒæ­¥å’Œå¼‚æ­¥ï¼Œå¯ä»¥é˜…è¯» <a href="https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Asynchronous/Introducing" target="_blank" rel="noreferrer">åŒæ­¥å’Œå¼‚æ­¥ JavaScript - MDN</a> ä¸€æ–‡ã€‚</p></div><h3 id="å…¨é‡æ›´æ–°-state" tabindex="-1">å…¨é‡æ›´æ–° state <a class="header-anchor" href="#å…¨é‡æ›´æ–°-state" aria-label="Permalink to â€œå…¨é‡æ›´æ–° stateâ€">â€‹</a></h3><p>åœ¨ <a href="#æ‰¹é‡æ›´æ–°-state">æ‰¹é‡æ›´æ–° state</a> äº†è§£åˆ°å¯ä»¥ç”¨ <code>store.$patch</code> æ–¹æ³•å¯¹æ•°æ®è¿›è¡Œæ‰¹é‡æ›´æ–°æ“ä½œï¼Œä¸è¿‡å¦‚å…¶å‘½åï¼Œè¿™ç§æ–¹å¼æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ â€œè¡¥ä¸æ›´æ–°â€ ã€‚</p><p>è™½ç„¶å¯ä»¥å¯¹æ‰€æœ‰æ•°æ®éƒ½æ‰§è¡Œä¸€æ¬¡ â€œè¡¥ä¸æ›´æ–°â€ æ¥è¾¾åˆ° â€œå…¨é‡æ›´æ–°â€ çš„ç›®çš„ï¼Œä½† Pinia ä¹Ÿæä¾›äº†ä¸€ä¸ªæ›´å¥½çš„åŠæ³•ã€‚</p><p>å‰é¢å¤šæ¬¡æåˆ° state æ•°æ®å¯ä»¥é€šè¿‡ <code>store.$state</code> æ‹¿åˆ°ï¼Œè€Œè¿™ä¸ªå±æ€§æœ¬èº«æ˜¯å¯ä»¥ç›´æ¥èµ‹å€¼çš„ã€‚</p><p>è¿˜æ˜¯ç»§ç»­ç”¨ä¸Šé¢çš„ä¾‹å­ï¼Œ state ä¸Šç°åœ¨æœ‰ <code>message</code> å’Œ <code>randomMessages</code> è¿™ä¸¤ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆè¦å…¨é‡æ›´æ–°ä¸ºæ–°çš„å€¼ï¼Œå°±è¿™ä¹ˆæ“ä½œï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.$state </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New Message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  randomMessages: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;msg1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;msg2&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;msg3&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>åŒæ ·çš„ï¼Œå¿…é¡»éµå¾ª state åŸæœ‰çš„æ•°æ®å’Œå¯¹åº”çš„ç±»å‹ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>è¯¥æ“ä½œä¸ä¼šä½¿ state å¤±å»å“åº”æ€§ã€‚</p></div><h3 id="é‡ç½®-state" tabindex="-1">é‡ç½® state <a class="header-anchor" href="#é‡ç½®-state" aria-label="Permalink to â€œé‡ç½® stateâ€">â€‹</a></h3><p>Pinia æä¾›äº†ä¸€ä¸ª <code>$reset</code> API æŒ‚åœ¨æ¯ä¸ªå®ä¾‹ä¸Šé¢ï¼Œç”¨äºé‡ç½®æ•´é¢— state æ ‘ä¸ºåˆå§‹æ•°æ®ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™ä¸ª store æ˜¯ä¸Šé¢å®šä¹‰å¥½çš„å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$reset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>å…·ä½“ä¾‹å­ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¿®æ”¹æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;New Message&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.message) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¾“å‡º New Message</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 3s åé‡ç½®çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$reset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.message) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¾“å‡ºæœ€å¼€å§‹çš„ Hello World</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="è®¢é˜…-state" tabindex="-1">è®¢é˜… state <a class="header-anchor" href="#è®¢é˜…-state" aria-label="Permalink to â€œè®¢é˜… stateâ€">â€‹</a></h3><p>å’Œ Vuex ä¸€æ ·ï¼Œ Pinia ä¹Ÿæä¾›äº†ä¸€ä¸ªç”¨äºè®¢é˜… state çš„ <code>$subscribe</code> API ã€‚</p><h4 id="è®¢é˜…-api-çš„-ts-ç±»å‹" tabindex="-1">è®¢é˜… API çš„ TS ç±»å‹ <a class="header-anchor" href="#è®¢é˜…-api-çš„-ts-ç±»å‹" aria-label="Permalink to â€œè®¢é˜… API çš„ TS ç±»å‹â€">â€‹</a></h4><p>åœ¨äº†è§£è¿™ä¸ª API çš„ä½¿ç”¨ä¹‹å‰ï¼Œå…ˆçœ‹ä¸€ä¸‹å®ƒçš„ TS ç±»å‹å®šä¹‰ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// $subscribe éƒ¨åˆ†çš„ TS ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$subscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  callback: SubscriptionCallback</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">S</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { detached?: boolean } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> WatchOptions</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">): () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> void</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ...</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ <code>$subscribe</code> å¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p><ol><li>ç¬¬ä¸€ä¸ªå…¥å‚æ˜¯ callback å‡½æ•°ï¼Œå¿…ä¼ ï¼›</li><li>ç¬¬äºŒä¸ªå…¥å‚æ˜¯ä¸€äº›é€‰é¡¹ï¼Œå¯é€‰ï¼›</li></ol><p>åŒæ—¶è¿˜ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œåå¯ä»¥ç”¨äºç§»é™¤å½“å‰è®¢é˜…ï¼Œä¸‹é¢æ¥çœ‹çœ‹å…·ä½“ç”¨æ³•ã€‚</p><h4 id="æ·»åŠ è®¢é˜…" tabindex="-1">æ·»åŠ è®¢é˜… <a class="header-anchor" href="#æ·»åŠ è®¢é˜…" aria-label="Permalink to â€œæ·»åŠ è®¢é˜…â€">â€‹</a></h4><p><code>$subscribe</code> API çš„åŠŸèƒ½ç±»ä¼¼äº <a href="./../introduction/component.html#watch">watch</a> ï¼Œä½†å®ƒåªä¼šåœ¨ state è¢«æ›´æ–°çš„æ—¶å€™æ‰è§¦å‘ä¸€æ¬¡ï¼Œå¹¶ä¸”åœ¨ç»„ä»¶è¢«å¸è½½æ—¶åˆ é™¤ï¼ˆå‚è€ƒï¼š<a href="./../introduction/component.html#ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ-new">ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸ</a>ï¼‰ã€‚</p><p>ä» <a href="#è®¢é˜…-api-çš„-ts-ç±»å‹">è®¢é˜… API çš„ TS ç±»å‹</a> å¯ä»¥çœ‹åˆ°ï¼Œå®ƒå¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¿…ä¼ çš„ callback å‡½æ•°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹é»˜è®¤ç”¨è¿™ä¸ªæ–¹å¼å³å¯ï¼Œä½¿ç”¨ä¾‹å­ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¯ä»¥åœ¨ state å‡ºç°å˜åŒ–æ—¶ï¼Œæ›´æ–°æœ¬åœ°æŒä¹…åŒ–å­˜å‚¨çš„æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$subscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mutation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  localStorage.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;store&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(state))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>è¿™ä¸ª callback é‡Œé¢æœ‰ 2 ä¸ªå…¥å‚ï¼š</p><table tabindex="0"><thead><tr><th style="text-align:center;">å…¥å‚</th><th style="text-align:center;">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:center;">mutation</td><td style="text-align:center;">æœ¬æ¬¡äº‹ä»¶çš„ä¸€äº›ä¿¡æ¯</td></tr><tr><td style="text-align:center;">state</td><td style="text-align:center;">å½“å‰å®ä¾‹çš„ state</td></tr></tbody></table><p>å…¶ä¸­ mutation åŒ…å«äº†ä»¥ä¸‹æ•°æ®ï¼š</p><table tabindex="0"><thead><tr><th style="text-align:center;">å­—æ®µ</th><th style="text-align:left;">å€¼</th></tr></thead><tbody><tr><td style="text-align:center;">storeId</td><td style="text-align:left;">å‘å¸ƒæœ¬æ¬¡è®¢é˜…é€šçŸ¥çš„ Pinia å®ä¾‹çš„å”¯ä¸€ IDï¼ˆç”± <a href="#åˆ›å»º-store-new">åˆ›å»º Store</a> æ—¶æŒ‡å®šï¼‰</td></tr><tr><td style="text-align:center;">type</td><td style="text-align:left;">æœ‰ 3 ä¸ªå€¼ï¼šè¿”å› <code>direct</code> ä»£è¡¨ <a href="#è·å–å’Œæ›´æ–°-state">ç›´æ¥æ›´æ”¹</a> æ•°æ®ï¼›è¿”å› <code>patch object</code> ä»£è¡¨æ˜¯é€šè¿‡ <a href="#ä¼ å…¥ä¸€ä¸ªå¯¹è±¡">ä¼ å…¥ä¸€ä¸ªå¯¹è±¡</a> æ›´æ”¹ï¼›è¿”å› <code>patch function</code> åˆ™ä»£è¡¨æ˜¯é€šè¿‡ <a href="#ä¼ å…¥ä¸€ä¸ªå‡½æ•°">ä¼ å…¥ä¸€ä¸ªå‡½æ•°</a> æ›´æ”¹</td></tr><tr><td style="text-align:center;">events</td><td style="text-align:left;">è§¦å‘æœ¬æ¬¡è®¢é˜…é€šçŸ¥çš„äº‹ä»¶åˆ—è¡¨</td></tr><tr><td style="text-align:center;">payload</td><td style="text-align:left;">é€šè¿‡ <a href="#ä¼ å…¥ä¸€ä¸ªå‡½æ•°">ä¼ å…¥ä¸€ä¸ªå‡½æ•°</a> æ›´æ”¹æ—¶ï¼Œä¼ é€’è¿›æ¥çš„è·è½½ä¿¡æ¯ï¼Œåªæœ‰ <code>type</code> ä¸º <code>patch object</code> æ—¶æ‰æœ‰</td></tr></tbody></table><p>å¦‚ä¸å¸Œæœ›ç»„ä»¶è¢«å¸è½½æ—¶åˆ é™¤è®¢é˜…ï¼Œå¯ä¼ é€’ç¬¬äºŒä¸ªå‚æ•° options ä»¥ä¿ç•™è®¢é˜…çŠ¶æ€ï¼Œä¼ å…¥ä¸€ä¸ªå¯¹è±¡ã€‚</p><p>å¯ä»¥ç®€å•æŒ‡å®šä¸º <code>{ detached: true }</code> ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$subscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mutation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { detached: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥æ­é… watch API çš„é€‰é¡¹ä¸€èµ·ç”¨ã€‚</p><h4 id="ç§»é™¤è®¢é˜…" tabindex="-1">ç§»é™¤è®¢é˜… <a class="header-anchor" href="#ç§»é™¤è®¢é˜…" aria-label="Permalink to â€œç§»é™¤è®¢é˜…â€">â€‹</a></h4><p>åœ¨ <a href="#æ·»åŠ è®¢é˜…">æ·»åŠ è®¢é˜…</a> éƒ¨åˆ†å·²äº†è§£è¿‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œç»„ä»¶è¢«å¸è½½æ—¶è®¢é˜…ä¹Ÿä¼šè¢«ä¸€å¹¶ç§»é™¤ï¼Œä½†å¦‚æœä¹‹å‰å¯ç”¨äº† <code>detached</code> é€‰é¡¹ï¼Œå°±éœ€è¦æ‰‹åŠ¨å–æ¶ˆäº†ã€‚</p><p>å‰é¢åœ¨ <a href="#è®¢é˜…-api-çš„-ts-ç±»å‹">è®¢é˜… API çš„ TS ç±»å‹</a> é‡Œæåˆ°ï¼Œåœ¨å¯ç”¨ <code>$subscribe</code> API ä¹‹åï¼Œä¼šæœ‰ä¸€ä¸ªå‡½æ•°ä½œä¸ºè¿”å›å€¼ï¼Œè¿™ä¸ªå‡½æ•°å¯ä»¥ç”¨æ¥å–æ¶ˆè¯¥è®¢é˜…ã€‚</p><p>ç”¨æ³•éå¸¸ç®€å•ï¼Œåšä¸€ä¸‹ç®€å•äº†è§£å³å¯ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å®šä¹‰ä¸€ä¸ªé€€è®¢å˜é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> unsubscribe</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$subscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">mutation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { detached: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åœ¨åˆé€‚çš„æ—¶æœŸè°ƒç”¨å®ƒï¼Œå¯ä»¥å–æ¶ˆè¿™ä¸ªè®¢é˜…</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">unsubscribe</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><p>è·Ÿ watch API çš„æœºåˆ¶éå¸¸ç›¸ä¼¼ï¼Œ å®ƒä¹Ÿæ˜¯è¿”å› <a href="./../introduction/component.html#å–æ¶ˆç›‘å¬">ä¸€ä¸ªå–æ¶ˆç›‘å¬çš„å‡½æ•°</a> ç”¨äºç§»é™¤æŒ‡å®šçš„ watch ã€‚</p><h2 id="ç®¡ç†-getters-new" tabindex="-1">ç®¡ç† getters ~new <a class="header-anchor" href="#ç®¡ç†-getters-new" aria-label="Permalink to â€œç®¡ç† getters ~newâ€">â€‹</a></h2><p>åœ¨ <a href="#çŠ¶æ€æ ‘çš„ç»“æ„">çŠ¶æ€æ ‘çš„ç»“æ„</a> äº†è§£è¿‡ï¼Œ Pinia çš„ <code>getters</code> æ˜¯ç”¨æ¥è®¡ç®—æ•°æ®çš„ã€‚</p><h3 id="ç»™-store-æ·»åŠ -getter" tabindex="-1">ç»™ Store æ·»åŠ  getter <a class="header-anchor" href="#ç»™-store-æ·»åŠ -getter" aria-label="Permalink to â€œç»™ Store æ·»åŠ  getterâ€">â€‹</a></h3><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>å¦‚æœå¯¹ Vue çš„è®¡ç®—æ•°æ®ä¸æ˜¯å¾ˆç†Ÿæ‚‰æˆ–è€…æ²¡æ¥è§¦è¿‡çš„è¯ï¼Œå¯ä»¥å…ˆäº†è§£ <a href="./../introduction/component.html#æ•°æ®çš„è®¡ç®—-new">æ•°æ®çš„è®¡ç®—</a> Computed APIã€‚</p></div><h4 id="æ·»åŠ æ™®é€šçš„-getter" tabindex="-1">æ·»åŠ æ™®é€šçš„ getter <a class="header-anchor" href="#æ·»åŠ æ™®é€šçš„-getter" aria-label="Permalink to â€œæ·»åŠ æ™®é€šçš„ getterâ€">â€‹</a></h4><p>ç»§ç»­ç”¨åˆšæ‰çš„ <code>message</code> ï¼Œæ¥å®šä¹‰ä¸€ä¸ª Getter ï¼Œç”¨äºè¿”å›ä¸€å¥æ‹¼æ¥å¥½çš„å¥å­ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å®šä¹‰ä¸€ä¸ª fullMessage çš„è®¡ç®—æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  getters: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    fullMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`The message is &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;.\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å’Œ <a href="./../introduction/component.html#å›é¡¾-vue-2-3">Options API çš„ Computed</a> å†™æ³•ä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡å‡½æ•°æ¥è¿”å›è®¡ç®—åçš„å€¼ï¼Œ Getter å¯ä»¥é€šè¿‡å…¥å‚çš„ <code>state</code> æ¥æ‹¿åˆ°å½“å‰å®ä¾‹çš„æ•°æ®ï¼ˆåœ¨ Pinia é‡Œï¼Œå®˜æ–¹æ›´æ¨èä½¿ç”¨ç®­å¤´å‡½æ•°ï¼‰ã€‚</p><h4 id="æ·»åŠ å¼•ç”¨-getter-çš„-getter" tabindex="-1">æ·»åŠ å¼•ç”¨ getter çš„ getter <a class="header-anchor" href="#æ·»åŠ å¼•ç”¨-getter-çš„-getter" aria-label="Permalink to â€œæ·»åŠ å¼•ç”¨ getter çš„ getterâ€">â€‹</a></h4><p>æœ‰æ—¶å€™å¯èƒ½è¦å¼•ç”¨å¦å¤–ä¸€ä¸ª getter çš„å€¼æ¥è¿”å›æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ä¸èƒ½ç”¨ç®­å¤´å‡½æ•°äº†ï¼Œéœ€è¦å®šä¹‰æˆæ™®é€šå‡½æ•°è€Œä¸æ˜¯ç®­å¤´å‡½æ•°ï¼Œå¹¶åœ¨å‡½æ•°å†…éƒ¨é€šè¿‡ <code>this</code> æ¥è°ƒç”¨å½“å‰ Store ä¸Šçš„æ•°æ®å’Œæ–¹æ³•ã€‚</p><p>ç»§ç»­åœ¨ä¸Šé¢çš„ä¾‹å­é‡Œï¼Œæ·»åŠ å¤šä¸€ä¸ª <code>emojiMessage</code> çš„ getter ï¼Œåœ¨è¿”å› <code>fullMessage</code> çš„ç»“æœçš„åŒæ—¶ï¼Œæ‹¼æ¥å¤šä¸€ä¸² emoji ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  getters: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    fullMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`The message is &quot;\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;.\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è¿™ä¸ª getter è¿”å›äº†å¦å¤–ä¸€ä¸ª getter çš„ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    emojiMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`ğŸ‰ğŸ‰ğŸ‰ \${</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fullMessage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å¦‚æœåªå†™ JavaScript ï¼Œå¯èƒ½å¯¹è¿™ä¸€æ¡æ‰€è¯´çš„é™åˆ¶è§‰å¾—å¾ˆå¥‡æ€ªï¼Œäº‹å®ä¸Šç”¨ JS å†™ç®­å¤´å‡½æ•°æ¥å¼•ç”¨ç¡®å®ä¸ä¼šæŠ¥é”™ï¼Œä½†å¦‚æœç”¨çš„æ˜¯ TypeScript ï¼Œä¸æŒ‰ç…§è¿™ä¸ªå†™æ³•ï¼Œåœ¨ VSCode æç¤ºå’Œæ‰§è¡Œ TSC æ£€æŸ¥çš„æ—¶å€™éƒ½ä¼šç»™æŠ›å‡ºä¸€æ¡é”™è¯¯ï¼š</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">src/stores/index.ts:9:42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> TS2339:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Property</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;fullMessage&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> does</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> exist</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> type</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{ message: string; } &amp; {}&#39;.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     emojiMessage:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (state) =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ğŸ‰ğŸ‰ğŸ‰</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">fullMessage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                                           ~~~~~~~~~~~</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Found</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src/stores/index.ts:9</span></span></code></pre></div><p>å¦å¤–å…³äºæ™®é€šå‡½æ•°çš„ TS è¿”å›ç±»å‹ï¼Œå®˜æ–¹å»ºè®®æ˜¾å¼çš„è¿›è¡Œæ ‡æ³¨ï¼Œå°±åƒè¿™ä¸ªä¾‹å­é‡Œçš„ <code>emojiMessage(): string</code> é‡Œçš„ <code>: string</code> ã€‚</p><h4 id="ç»™-getter-ä¼ é€’å‚æ•°" tabindex="-1">ç»™ getter ä¼ é€’å‚æ•° <a class="header-anchor" href="#ç»™-getter-ä¼ é€’å‚æ•°" aria-label="Permalink to â€œç»™ getter ä¼ é€’å‚æ•°â€">â€‹</a></h4><p>getter æœ¬èº«æ˜¯ä¸æ”¯æŒå‚æ•°çš„ï¼Œä½†å’Œ Vuex ä¸€æ ·ï¼Œæ”¯æŒè¿”å›ä¸€ä¸ªå…·å¤‡å…¥å‚çš„å‡½æ•°ï¼Œç”¨æ¥æ»¡è¶³éœ€æ±‚ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  getters: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å®šä¹‰ä¸€ä¸ªæ¥æ”¶å…¥å‚çš„å‡½æ•°ä½œä¸ºè¿”å›å€¼</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    signedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`\${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">} say: &quot;The message is \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">state</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">message</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&quot;.\`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>è°ƒç”¨çš„æ—¶å€™æ˜¯è¿™æ ·ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> signedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">signedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Petter&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;signedMessage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, signedMessage)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Petter say: &quot;The message is Hello World&quot;.</span></span></code></pre></div><p>è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ª getter åªæ˜¯è°ƒç”¨çš„å‡½æ•°çš„ä½œç”¨ï¼Œä¸å†æœ‰ç¼“å­˜ï¼Œå¦‚æœé€šè¿‡å˜é‡å®šä¹‰äº†è¿™ä¸ªæ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡ä¹Ÿåªæ˜¯æ™®é€šå˜é‡ï¼Œä¸å…·å¤‡å“åº”æ€§ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é€šè¿‡å˜é‡å®šä¹‰ä¸€ä¸ªå€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> signedMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">signedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Petter&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;signedMessage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, signedMessage)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Petter say: &quot;The message is Hello World&quot;.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 2s åæ”¹å˜ message</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;New Message&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // signedMessage ä¸ä¼šå˜</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;signedMessage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, signedMessage)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Petter say: &quot;The message is Hello World&quot;.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // å¿…é¡»è¿™æ ·å†æ¬¡æ‰§è¡Œæ‰èƒ½æ‹¿åˆ°æ›´æ–°åçš„å€¼</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;signedMessage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">signedMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Petter&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Petter say: &quot;The message is New Message&quot;.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="è·å–å’Œæ›´æ–°-getter" tabindex="-1">è·å–å’Œæ›´æ–° getter <a class="header-anchor" href="#è·å–å’Œæ›´æ–°-getter" aria-label="Permalink to â€œè·å–å’Œæ›´æ–° getterâ€">â€‹</a></h3><p>getter å’Œ state éƒ½å±äºæ•°æ®ç®¡ç†ï¼Œè¯»å–å’Œèµ‹å€¼çš„æ–¹æ³•æ˜¯ä¸€æ ·çš„ï¼Œè¯·å‚è€ƒä¸Šæ–¹ <a href="#è·å–å’Œæ›´æ–°-state-new">è·å–å’Œæ›´æ–° state</a> ä¸€èŠ‚çš„å†…å®¹ã€‚</p><h2 id="ç®¡ç†-actions-new" tabindex="-1">ç®¡ç† actions ~new <a class="header-anchor" href="#ç®¡ç†-actions-new" aria-label="Permalink to â€œç®¡ç† actions ~newâ€">â€‹</a></h2><p>åœ¨ <a href="#çŠ¶æ€æ ‘çš„ç»“æ„">çŠ¶æ€æ ‘çš„ç»“æ„</a> æåˆ°äº†ï¼Œ Pinia åªéœ€è¦ç”¨ <code>actions</code> å°±å¯ä»¥è§£å†³å„ç§æ•°æ®æ“ä½œï¼Œæ— éœ€åƒ Vuex ä¸€æ ·åŒºåˆ†ä¸º <code>mutations / actions</code> ä¸¤å¤§ç±»ã€‚</p><h3 id="ç»™-store-æ·»åŠ -action" tabindex="-1">ç»™ Store æ·»åŠ  action <a class="header-anchor" href="#ç»™-store-æ·»åŠ -action" aria-label="Permalink to â€œç»™ Store æ·»åŠ  actionâ€">â€‹</a></h3><p>å¯ä»¥ä¸ºå½“å‰ Store å°è£…ä¸€äº›å¯ä»¥å¼€ç®±å³ç”¨çš„æ–¹æ³•ï¼Œæ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/index.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  actions: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å¼‚æ­¥æ›´æ–° message</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    async</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> updateMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt; {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Promise</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // è¿™é‡Œçš„ this æ˜¯å½“å‰çš„ Store å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">          this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newMessage</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">          resolve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Async done.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // åŒæ­¥æ›´æ–° message</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    updateMessageSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">newMessage</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // è¿™é‡Œçš„ this æ˜¯å½“å‰çš„ Store å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> newMessage</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      return</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Sync done.&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ action é‡Œï¼Œå¦‚æœè¦è®¿é—®å½“å‰å®ä¾‹çš„ state æˆ–è€… getter ï¼Œåªéœ€è¦é€šè¿‡ <code>this</code> å³å¯æ“ä½œï¼Œæ–¹æ³•çš„å…¥å‚å®Œå…¨ä¸å†å— Vuex é‚£æ ·æœ‰å›ºå®šå½¢å¼çš„å›°æ‰°ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>åœ¨ action é‡Œï¼Œ <code>this</code> æ˜¯å½“å‰çš„ Store å®ä¾‹ï¼Œæ‰€ä»¥å¦‚æœçš„ action æ–¹æ³•é‡Œæœ‰å…¶ä»–å‡½æ•°ä¹Ÿè¦è°ƒç”¨å®ä¾‹ï¼Œè¯·è®°å¾—å†™æˆ <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/Arrow_functions" target="_blank" rel="noreferrer">ç®­å¤´å‡½æ•°</a> æ¥æå‡ this ã€‚</p></div><h3 id="è°ƒç”¨-action" tabindex="-1">è°ƒç”¨ action <a class="header-anchor" href="#è°ƒç”¨-action" aria-label="Permalink to â€œè°ƒç”¨ actionâ€">â€‹</a></h3><p>åƒæ™®é€šçš„å‡½æ•°ä¸€æ ·ä½¿ç”¨å³å¯ï¼Œä¸éœ€è¦å’Œ Vuex ä¸€æ ·æ‰§è¡Œ commit æˆ–è€… dispatchï¼Œåœ¨ Pinia ï¼Œä¸éœ€è¦ï¼Œä¸éœ€è¦ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">message</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> storeToRefs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ç«‹å³æ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateMessageSync</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New message by sync.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 3s åæ‰§è¡Œ</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    store.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">updateMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;New message by async.&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">then</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(res))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      message,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h2 id="æ·»åŠ å¤šä¸ª-store-new" tabindex="-1">æ·»åŠ å¤šä¸ª Store ~new <a class="header-anchor" href="#æ·»åŠ å¤šä¸ª-store-new" aria-label="Permalink to â€œæ·»åŠ å¤šä¸ª Store ~newâ€">â€‹</a></h2><p>åˆ°è¿™é‡Œï¼Œå¯¹å•ä¸ª Store çš„é…ç½®å’Œè°ƒç”¨ç›¸ä¿¡éƒ½å·²ç»æ¸…æ¥šäº†ï¼Œå®é™…é¡¹ç›®ä¸­ä¼šæ¶‰åŠåˆ°å¾ˆå¤šæ•°æ®æ“ä½œï¼Œè¿˜å¯ä»¥ç”¨å¤šä¸ª Store æ¥ç»´æŠ¤ä¸åŒéœ€æ±‚æ¨¡å—çš„æ•°æ®çŠ¶æ€ã€‚</p><p>è¿™ä¸€ç‚¹å’Œ Vuex çš„ <a href="https://vuex.vuejs.org/zh/guide/modules.html" target="_blank" rel="noreferrer">Module</a> æ¯”è¾ƒç›¸ä¼¼ï¼Œç›®çš„éƒ½æ˜¯ä¸ºäº†é¿å…çŠ¶æ€æ ‘è¿‡äºè‡ƒè‚¿ï¼Œä½†ç”¨èµ·æ¥ä¼šæ›´ä¸ºç®€å•ã€‚</p><h3 id="ç›®å½•ç»“æ„å»ºè®®" tabindex="-1">ç›®å½•ç»“æ„å»ºè®® <a class="header-anchor" href="#ç›®å½•ç»“æ„å»ºè®®" aria-label="Permalink to â€œç›®å½•ç»“æ„å»ºè®®â€">â€‹</a></h3><p>å»ºè®®ç»Ÿä¸€å­˜æ”¾åœ¨ <code>src/stores</code> ä¸‹é¢ç®¡ç†ï¼Œæ ¹æ®ä¸šåŠ¡éœ€è¦è¿›è¡Œå‘½åï¼Œæ¯”å¦‚ <code>user</code> å°±ç”¨æ¥ç®¡ç†ç™»å½•ç”¨æˆ·ç›¸å…³çš„çŠ¶æ€æ•°æ®ã€‚</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">â””â”€stores</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  â”‚</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # å…¥å£æ–‡ä»¶</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  â”œâ”€index.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  â”‚</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # å¤šä¸ª store</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  â”œâ”€user.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  â”œâ”€game.ts</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  â””â”€news.ts</span></span></code></pre></div><p>é‡Œé¢æš´éœ²çš„æ–¹æ³•å°±ç»Ÿä¸€ä»¥ <code>use</code> å¼€å¤´åŠ ä¸Šæ–‡ä»¶åï¼Œå¹¶ä»¥ <code>Store</code> ç»“å°¾ï¼Œä½œä¸ºå°é©¼å³°å†™æ³•ï¼Œæ¯”å¦‚ <code>user</code> è¿™ä¸ª Store æ–‡ä»¶é‡Œé¢å¯¼å‡ºçš„å‡½æ•°åå°±æ˜¯ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/user.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useUserStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>ç„¶åä»¥ <code>index.ts</code> é‡Œä½œä¸ºç»Ÿä¸€çš„å…¥å£æ–‡ä»¶ï¼Œ <code>index.ts</code> é‡Œçš„ä»£ç å†™ä¸ºï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./user&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./game&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./news&#39;</span></span></code></pre></div><p>è¿™æ ·åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œåªéœ€è¦ä» <code>@/stores</code> é‡Œå¯¼å…¥å³å¯ï¼Œæ— éœ€å†™å®Œæ•´çš„è·¯å¾„ï¼Œä¾‹å¦‚ï¼Œåªéœ€è¦è¿™æ ·ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useUserStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span></code></pre></div><p>è€Œæ— éœ€è¿™æ ·ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useUserStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores/user&#39;</span></span></code></pre></div><h3 id="åœ¨-vue-ç»„ä»¶-ts-æ–‡ä»¶é‡Œä½¿ç”¨" tabindex="-1">åœ¨ Vue ç»„ä»¶ / TS æ–‡ä»¶é‡Œä½¿ç”¨ <a class="header-anchor" href="#åœ¨-vue-ç»„ä»¶-ts-æ–‡ä»¶é‡Œä½¿ç”¨" aria-label="Permalink to â€œåœ¨ Vue ç»„ä»¶ / TS æ–‡ä»¶é‡Œä½¿ç”¨â€">â€‹</a></h3><p>è¿™é‡Œä»¥ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ä¸šåŠ¡åœºæ™¯ä¸¾ä¾‹ï¼Œå¸Œæœ›èƒ½å¤Ÿæ–¹ä¾¿çš„ç†è§£å¦‚ä½•åŒæ—¶ä½¿ç”¨å¤šä¸ª Store ã€‚</p><p>å‡è®¾ç›®å‰æœ‰ä¸€ä¸ª <code>userStore</code> æ˜¯ç®¡ç†å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯ï¼Œ <code>gameStore</code> æ˜¯ç®¡ç†æ¸¸æˆçš„ä¿¡æ¯ï¼Œè€Œ â€œä¸ªäººä¸­å¿ƒâ€ è¿™ä¸ªé¡µé¢éœ€è¦å±•ç¤º â€œç”¨æˆ·ä¿¡æ¯â€ ï¼Œä»¥åŠ â€œè¯¥ç”¨æˆ·ç»‘å®šçš„æ¸¸æˆä¿¡æ¯â€ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿™æ ·ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineComponent, onMounted, ref } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { storeToRefs } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// è¿™é‡Œå¯¼å…¥è¦ç”¨åˆ°çš„ Store</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useUserStore, useGameStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/stores&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { GameItem } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/types&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // å…ˆä» userStore è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆå·²ç»ç™»å½•è¿‡ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ‹¿åˆ°ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useUserStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userId</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">userName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> storeToRefs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userStore)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // ä½¿ç”¨ gameStore é‡Œçš„æ–¹æ³•ï¼Œä¼ å…¥ç”¨æˆ· ID å»æŸ¥è¯¢ç”¨æˆ·çš„æ¸¸æˆåˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gameStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useGameStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gameList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ref</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GameItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]&gt;([])</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    onMounted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      gameList.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> gameStore.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">queryGameList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userId.value)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userId,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      userName,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      gameList,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å†æ¬¡æé†’ï¼Œåˆ‡è®°æ¯ä¸ª Store çš„ ID å¿…é¡»ä¸åŒï¼Œå¦‚æœ ID é‡å¤ï¼Œåœ¨åŒä¸€ä¸ª Vue ç»„ä»¶ / TS æ–‡ä»¶é‡Œå®šä¹‰ Store å®ä¾‹å˜é‡çš„æ—¶å€™ï¼Œä¼šä»¥å…ˆå®šä¹‰çš„ä¸ºæœ‰æ•ˆå€¼ï¼Œåç»­å®šä¹‰çš„ä¼šå’Œå‰é¢ä¸€æ ·ã€‚</p><p>å¦‚æœå…ˆå®šä¹‰äº† userStore :</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‡è®¾ä¸¤ä¸ª Store çš„ ID ä¸€æ ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useUserStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ˜¯æƒ³è¦çš„ Store</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gameStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useGameStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¾—åˆ°çš„ä¾ç„¶æ˜¯ userStore çš„é‚£ä¸ª Store</span></span></code></pre></div><p>å¦‚æœå…ˆå®šä¹‰äº† gameStore :</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‡è®¾ä¸¤ä¸ª Store çš„ ID ä¸€æ ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> gameStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useGameStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ˜¯æƒ³è¦çš„ Store</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useUserStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¾—åˆ°çš„ä¾ç„¶æ˜¯ gameStore çš„é‚£ä¸ª Store</span></span></code></pre></div><h3 id="store-ä¹‹é—´äº’ç›¸å¼•ç”¨" tabindex="-1">Store ä¹‹é—´äº’ç›¸å¼•ç”¨ <a class="header-anchor" href="#store-ä¹‹é—´äº’ç›¸å¼•ç”¨" aria-label="Permalink to â€œStore ä¹‹é—´äº’ç›¸å¼•ç”¨â€">â€‹</a></h3><p>å¦‚æœåœ¨å®šä¹‰ä¸€ä¸ª Store çš„æ—¶å€™ï¼Œè¦å¼•ç”¨å¦å¤–ä¸€ä¸ª Store çš„æ•°æ®ï¼Œä¹Ÿæ˜¯å¾ˆç®€å•ï¼Œå›åˆ°é‚£ä¸ª message çš„ä¾‹å­ï¼Œæ·»åŠ ä¸€ä¸ª getter ï¼Œå®ƒä¼šè¿”å›ä¸€å¥é—®å€™è¯­æ¬¢è¿ç”¨æˆ·ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/message.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¯¼å…¥ç”¨æˆ·ä¿¡æ¯çš„ Store å¹¶å¯ç”¨å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useUserStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./user&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useUserStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useMessageStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  getters: {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // è¿™é‡Œå°±å¯ä»¥ç›´æ¥å¼•ç”¨ userStore ä¸Šé¢çš„æ•°æ®äº†</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`Welcome, \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">userStore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">userName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}!\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å‡è®¾ç°åœ¨ <code>userName</code> æ˜¯ Petter ï¼Œé‚£ä¹ˆä¼šå¾—åˆ°ä¸€å¥å¯¹ Petter çš„é—®å€™ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> messageStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useMessageStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(messageStore.greeting) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Welcome, Petter!</span></span></code></pre></div><h2 id="ä¸“å±æ’ä»¶çš„ä½¿ç”¨-new" tabindex="-1">ä¸“å±æ’ä»¶çš„ä½¿ç”¨ ~new <a class="header-anchor" href="#ä¸“å±æ’ä»¶çš„ä½¿ç”¨-new" aria-label="Permalink to â€œä¸“å±æ’ä»¶çš„ä½¿ç”¨ ~newâ€">â€‹</a></h2><p>Pinia æ‹¥æœ‰éå¸¸çµæ´»çš„å¯æ‰©å±•æ€§ï¼Œæœ‰ä¸“å±æ’ä»¶å¯ä»¥å¼€ç®±å³ç”¨æ»¡è¶³æ›´å¤šçš„éœ€æ±‚åœºæ™¯ã€‚</p><h3 id="å¦‚ä½•æŸ¥æ‰¾æ’ä»¶" tabindex="-1">å¦‚ä½•æŸ¥æ‰¾æ’ä»¶ <a class="header-anchor" href="#å¦‚ä½•æŸ¥æ‰¾æ’ä»¶" aria-label="Permalink to â€œå¦‚ä½•æŸ¥æ‰¾æ’ä»¶â€">â€‹</a></h3><p>æ’ä»¶æœ‰ç»Ÿä¸€çš„å‘½åæ ¼å¼ <code>pinia-plugin-*</code> ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ npmjs ä¸Šæœç´¢è¿™ä¸ªå…³é”®è¯æ¥æŸ¥è¯¢ç›®å‰æœ‰å“ªäº›æ’ä»¶å·²å‘å¸ƒã€‚</p><p>ç‚¹å‡»æŸ¥è¯¢ï¼š <a href="https://www.npmjs.com/search?q=pinia-plugin" target="_blank" rel="noreferrer">pinia-plugin - npmjs</a></p><h3 id="å¦‚ä½•ä½¿ç”¨æ’ä»¶" tabindex="-1">å¦‚ä½•ä½¿ç”¨æ’ä»¶ <a class="header-anchor" href="#å¦‚ä½•ä½¿ç”¨æ’ä»¶" aria-label="Permalink to â€œå¦‚ä½•ä½¿ç”¨æ’ä»¶â€">â€‹</a></h3><p>è¿™é‡Œä»¥ <a href="https://www.npmjs.com/package/pinia-plugin-persistedstate" target="_blank" rel="noreferrer">pinia-plugin-persistedstate</a> ä¸ºä¾‹ï¼Œè¿™æ˜¯ä¸€ä¸ªè®©æ•°æ®æŒä¹…åŒ–å­˜å‚¨çš„ Pinia æ’ä»¶ã€‚</p><div class="tip custom-block"><p class="custom-block-title custom-block-title-default">TIP</p><p>æ•°æ®æŒä¹…åŒ–å­˜å‚¨ï¼ŒæŒ‡é¡µé¢å…³é—­åå†æ‰“å¼€ï¼Œæµè§ˆå™¨ä¾ç„¶å¯ä»¥è®°å½•ä¹‹å‰ä¿å­˜çš„æœ¬åœ°æ•°æ®ï¼Œä¾‹å¦‚ï¼šæµè§ˆå™¨åŸç”Ÿçš„ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/localStorage" target="_blank" rel="noreferrer">localStorage</a> å’Œ <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/IndexedDB_API" target="_blank" rel="noreferrer">IndexedDB</a> ï¼Œæˆ–è€…æ˜¯ä¸€äº›å…¼å®¹å¤šç§åŸç”Ÿæ–¹æ¡ˆå¹¶ç»Ÿä¸€ç”¨æ³•çš„ç¬¬ä¸‰æ–¹æ–¹æ¡ˆï¼Œä¾‹å¦‚ï¼š <a href="https://github.com/localForage/localForage" target="_blank" rel="noreferrer">localForage</a> ã€‚</p></div><p>æ’ä»¶ä¹Ÿæ˜¯ç‹¬ç«‹çš„ npm åŒ…ï¼Œéœ€è¦å…ˆå®‰è£…ï¼Œå†æ¿€æ´»ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨ã€‚</p><p>æ¿€æ´»æ–¹æ³•ä¼šæ¶‰åŠåˆ° Pinia çš„åˆå§‹åŒ–è¿‡ç¨‹è°ƒæ•´ï¼Œè¿™é‡Œä¸å±€é™äºæŸä¸€ä¸ªæ’ä»¶ï¼Œé€šç”¨çš„æ’ä»¶ç”¨æ³•å¦‚ä¸‹ï¼ˆè¯·ç•™æ„ä»£ç æ³¨é‡Šï¼‰ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/main.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createApp } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> App </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@/App.vue&#39;</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { createPinia } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // å¯¼å…¥ Pinia</span></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> piniaPluginPersistedstate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia-plugin-persistedstate&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // å¯¼å…¥ Pinia æ’ä»¶</span></span>
<span class="line"></span>
<span class="line highlighted"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> pinia</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createPinia</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// åˆå§‹åŒ– Pinia</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">pinia.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(piniaPluginPersistedstate) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¿€æ´» Pinia æ’ä»¶</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createApp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(App)</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pinia) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å¯ç”¨ Pinia ï¼Œè¿™ä¸€æ¬¡æ˜¯åŒ…å«äº†æ’ä»¶çš„ Pinia å®ä¾‹</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  .</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#app&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h4 id="ä½¿ç”¨å‰" tabindex="-1">ä½¿ç”¨å‰ <a class="header-anchor" href="#ä½¿ç”¨å‰" aria-label="Permalink to â€œä½¿ç”¨å‰â€">â€‹</a></h4><p>Pinia é»˜è®¤åœ¨é¡µé¢åˆ·æ–°æ—¶ä¼šä¸¢å¤±å½“å‰å˜æ›´çš„æ•°æ®ï¼Œæ²¡æœ‰åœ¨æœ¬åœ°åšæŒä¹…åŒ–è®°å½•ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…¶ä»–ä»£ç çœç•¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useMessageStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‡è®¾åˆå§‹å€¼æ˜¯ Hello World</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2s åå˜æˆ Hello World!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;!&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é¡µé¢åˆ·æ–°ååˆå˜å›äº† Hello World</span></span></code></pre></div><h4 id="ä½¿ç”¨å" tabindex="-1">ä½¿ç”¨å <a class="header-anchor" href="#ä½¿ç”¨å" aria-label="Permalink to â€œä½¿ç”¨åâ€">â€‹</a></h4><p>æŒ‰ç…§ persistedstate æ’ä»¶çš„æ–‡æ¡£è¯´æ˜ï¼Œåœ¨å…¶ä¸­ä¸€ä¸ª Store å¯ç”¨å®ƒï¼Œåªéœ€è¦æ·»åŠ ä¸€ä¸ª <code>persist: true</code> çš„é€‰é¡¹å³å¯å¼€å¯ï¼š</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// src/stores/message.ts</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { defineStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;pinia&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useUserStore } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./user&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> userStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useUserStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> useMessageStore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;message&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  state</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Hello World&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  getters: {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    greeting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> \`Welcome, \${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">userStore</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">userName</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}\`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line highlighted"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // è¿™æ˜¯æŒ‰ç…§æ’ä»¶çš„æ–‡æ¡£ï¼Œåœ¨å®ä¾‹ä¸Šå¯ç”¨äº†è¯¥æ’ä»¶ï¼Œè¿™ä¸ªé€‰é¡¹æ˜¯æ’ä»¶ç‰¹æœ‰çš„</span></span>
<span class="line highlighted"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  persist: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><p>å›åˆ°çš„é¡µé¢ï¼Œç°åœ¨è¿™ä¸ª Store å…·å¤‡äº†æŒä¹…åŒ–è®°å¿†çš„åŠŸèƒ½äº†ï¼Œå®ƒä¼šä» localStorage è¯»å–åŸæ¥çš„æ•°æ®ä½œä¸ºåˆå§‹å€¼ï¼Œæ¯ä¸€æ¬¡å˜åŒ–åä¹Ÿä¼šå°†å…¶å†™å…¥ localStorage è¿›è¡Œè®°å¿†å­˜å‚¨ã€‚</p><div class="language-ts"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å…¶ä»–ä»£ç çœç•¥</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> store</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useMessageStore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å‡è®¾åˆå§‹å€¼æ˜¯ Hello World</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2s åå˜æˆ Hello World!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> store.message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;!&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// é¡µé¢åˆ·æ–°åå˜æˆäº† Hello World!!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å†æ¬¡åˆ·æ–°åå˜æˆäº† Hello World!!!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// å†æ¬¡åˆ·æ–°åå˜æˆäº† Hello World!!!!</span></span></code></pre></div><p>å¯ä»¥åœ¨æµè§ˆå™¨æŸ¥çœ‹åˆ° localStorage çš„å­˜å‚¨å˜åŒ–ï¼Œä»¥ Chrome æµè§ˆå™¨ä¸ºä¾‹ï¼ŒæŒ‰ F12 ï¼Œæ‰“å¼€ Application é¢æ¿ï¼Œé€‰æ‹© Local Storage ï¼Œå¯ä»¥çœ‹åˆ°ä»¥å½“å‰ Store ID ä¸º Key çš„å­˜å‚¨æ•°æ®ã€‚</p><p>è¿™æ˜¯å…¶ä¸­ä¸€ä¸ªæ’ä»¶ä½¿ç”¨çš„ä¾‹å­ï¼Œæ›´å¤šçš„ç”¨æ³•è¯·æ ¹æ®è‡ªå·±é€‰æ‹©çš„æ’ä»¶çš„ README è¯´æ˜æ“ä½œã€‚</p>`,230)]))}const o=i(e,[["render",h]]);export{g as __pageData,o as default};
